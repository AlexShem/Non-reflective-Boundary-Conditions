syms nu mu x w;
% syms a b c d;
a = 3/(12*mu + 4) - .5; b = 9*nu/(3*mu + 1) - 2; c = 1 - (12*nu + 3) / (6*mu + 2); d = 3*nu / (6*mu + 2);

eq1 = d*w*x^4 + (a*(1+w^2)+c*w)*x^3 + (1+w^2+b*w)*x^2 + (a*(1+w^2)+c*w)*x + d*w;
eq2 = 4*d*w*x^3 + 3*(a*(1+w^2)+c*w)*x^2 + 2*(1+w^2+b*w)*x + a*(1+w^2)-c*w;

eq1_cf = flip(coeffs(eq1, x));
eq2_cf = flip(coeffs(eq2, x));
[p1, r1] = division_sym(eq1_cf, eq2_cf, x);
p1_cf = flip(coeffs(p1, x));
r1_cf = flip(coeffs(r1, x));
[p2, r2] = division_sym(eq2_cf, r1_cf, x);
p2_cf = flip(coeffs(p2, x));
r2_cf = flip(coeffs(r2, x));
[p3, r3] = division_sym(r1_cf, r2_cf, x);

[num, denum] = numden(r3);
rts = solve(num == 0, w);

und_sq = @(nu, mu) -nu*(6*mu - 7)*(28*nu - 12*mu - 24*mu*nu + 36*mu^2 + 1);
syms z;
root = (27216*mu^4 - 46656*mu^5 - 5184*mu^3 + 216*mu^2 + 36*mu - 3)*z^12 + (720*nu - 432*mu + 3456*mu*nu - 124416*mu^2*nu + 497664*mu^3*nu - 186624*mu^4*nu - 2592*mu^2 + 62208*mu^3 - 326592*mu^4 + 559872*mu^5 + 36)*z^11 + (186624*mu^6 - 746496*mu^5*nu - 2519424*mu^5 + 746496*mu^4*nu^2 - 497664*mu^4*nu + 1438560*mu^4 + 2488320*mu^3*nu^2 - 3939840*mu^3*nu - 276480*mu^3 + 870912*mu^2*nu^2 + 1154304*mu^2*nu + 12960*mu^2 - 1257984*mu*nu^2 - 44352*mu*nu + 1656*mu - 13248*nu^2 - 5952*nu - 146)*z^10 + (2239488*mu^5*nu - 746496*mu^6 + 5038848*mu^5 + 15489792*mu^4*nu - 2814912*mu^4 - 2985984*mu^3*nu^3 - 31352832*mu^3*nu^2 + 8833536*mu^3*nu + 546048*mu^3 + 8957952*mu^2*nu^3 + 9704448*mu^2*nu^2 - 3649536*mu^2*nu - 28512*mu^2 - 14681088*mu*nu^3 + 8335872*mu*nu^2 + 184896*mu*nu - 2736*mu - 3760128*nu^3 - 20736*nu^2 + 17424*nu + 260)*z^9 + (746496*mu^6 + 4478976*mu^5*nu - 2939328*mu^5 - 32845824*mu^4*nu^2 - 79128576*mu^4*nu + 1590192*mu^4 + 53747712*mu^3*nu^3 + 165224448*mu^3*nu^2 + 3732480*mu^3*nu - 312768*mu^3 - 23887872*mu^2*nu^4 - 95551488*mu^2*nu^3 - 96546816*mu^2*nu^2 + 4396032*mu^2*nu + 18792*mu^2 + 19906560*mu*nu^4 + 140838912*mu*nu^3 - 19795968*mu*nu^2 - 328320*mu*nu + 1116*mu - 44457984*nu^4 + 14764032*nu^3 + 16128*nu^2 - 24192*nu - 125)*z^8 + (746496*mu^6 - 26127360*mu^5*nu - 5598720*mu^5 + 119439360*mu^4*nu^2 + 189734400*mu^4*nu + 3141504*mu^4 - 188116992*mu^3*nu^3 - 430479360*mu^3*nu^2 - 43835904*mu^3*nu - 608256*mu^3 + 95551488*mu^2*nu^4 + 373248000*mu^2*nu^3 + 290884608*mu^2*nu^2 - 96768*mu^2*nu + 31104*mu^2 - 222953472*mu*nu^4 - 455113728*mu*nu^3 + 23293440*mu*nu^2 + 272448*mu*nu + 3168*mu + 95551488*nu^5 + 201719808*nu^4 - 23224320*nu^3 + 389376*nu^2 + 17184*nu - 296)*z^7 + (40310784*mu^5*nu - 1866240*mu^6 + 11010816*mu^5 - 177666048*mu^4*nu^2 - 250822656*mu^4*nu - 6111936*mu^4 + 298598400*mu^3*nu^3 + 590229504*mu^3*nu^2 + 69424128*mu^3*nu + 1188864*mu^3 - 214990848*mu^2*nu^4 - 585252864*mu^2*nu^3 - 410323968*mu^2*nu^2 - 3359232*mu^2*nu - 63936*mu^2 + 95551488*mu*nu^5 + 429981696*mu*nu^4 + 659902464*mu*nu^3 - 21095424*mu*nu^2 - 176256*mu*nu - 5616*mu - 47775744*nu^6 - 207028224*nu^5 - 316514304*nu^4 + 24330240*nu^3 - 745344*nu^2 - 10368*nu + 548)*z^6 + (746496*mu^6 - 26127360*mu^5*nu - 5598720*mu^5 + 119439360*mu^4*nu^2 + 189734400*mu^4*nu + 3141504*mu^4 - 188116992*mu^3*nu^3 - 430479360*mu^3*nu^2 - 43835904*mu^3*nu - 608256*mu^3 + 95551488*mu^2*nu^4 + 373248000*mu^2*nu^3 + 290884608*mu^2*nu^2 - 96768*mu^2*nu + 31104*mu^2 - 222953472*mu*nu^4 - 455113728*mu*nu^3 + 23293440*mu*nu^2 + 272448*mu*nu + 3168*mu + 95551488*nu^5 + 201719808*nu^4 - 23224320*nu^3 + 389376*nu^2 + 17184*nu - 296)*z^5 + (746496*mu^6 + 4478976*mu^5*nu - 2939328*mu^5 - 32845824*mu^4*nu^2 - 79128576*mu^4*nu + 1590192*mu^4 + 53747712*mu^3*nu^3 + 165224448*mu^3*nu^2 + 3732480*mu^3*nu - 312768*mu^3 - 23887872*mu^2*nu^4 - 95551488*mu^2*nu^3 - 96546816*mu^2*nu^2 + 4396032*mu^2*nu + 18792*mu^2 + 19906560*mu*nu^4 + 140838912*mu*nu^3 - 19795968*mu*nu^2 - 328320*mu*nu + 1116*mu - 44457984*nu^4 + 14764032*nu^3 + 16128*nu^2 - 24192*nu - 125)*z^4 + (2239488*mu^5*nu - 746496*mu^6 + 5038848*mu^5 + 15489792*mu^4*nu - 2814912*mu^4 - 2985984*mu^3*nu^3 - 31352832*mu^3*nu^2 + 8833536*mu^3*nu + 546048*mu^3 + 8957952*mu^2*nu^3 + 9704448*mu^2*nu^2 - 3649536*mu^2*nu - 28512*mu^2 - 14681088*mu*nu^3 + 8335872*mu*nu^2 + 184896*mu*nu - 2736*mu - 3760128*nu^3 - 20736*nu^2 + 17424*nu + 260)*z^3 + (186624*mu^6 - 746496*mu^5*nu - 2519424*mu^5 + 746496*mu^4*nu^2 - 497664*mu^4*nu + 1438560*mu^4 + 2488320*mu^3*nu^2 - 3939840*mu^3*nu - 276480*mu^3 + 870912*mu^2*nu^2 + 1154304*mu^2*nu + 12960*mu^2 - 1257984*mu*nu^2 - 44352*mu*nu + 1656*mu - 13248*nu^2 - 5952*nu - 146)*z^2 + (720*nu - 432*mu + 3456*mu*nu - 124416*mu^2*nu + 497664*mu^3*nu - 186624*mu^4*nu - 2592*mu^2 + 62208*mu^3 - 326592*mu^4 + 559872*mu^5 + 36)*z - 46656*mu^5 + 27216*mu^4 - 5184*mu^3 + 216*mu^2 + 36*mu - 3;

